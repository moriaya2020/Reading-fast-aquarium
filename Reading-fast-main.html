<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.1/TweenMax.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/85188/jquery.wavify.js"></script>
</head>

<body onload="swiming()">
  <div id="play" class="hide">
    <input type="button" value="スクロール開始！" onClick="scrollPage()">
    <input type="button" value="スクロール停止！" onClick="scrollSTOP()">
    <div id="scroll_area" style="overflow:scroll; height: 200px; width: 500px; margin: 0 auto;">
      <p id="text"></p>
      <h1 style="font-size: 80px;">おわり</h1>
    </div>
  </div>
  <h1>〜早く読んで魚を守ろう〜</h1>
  <div id="prepare">
    <textarea name="resource" id="resource" cols="100" rows="10"></textarea>
    <input type="button" value="決定！" onClick="kettei()">
  </div>
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path id="wave" transform="scale(10, 10)">
  </svg>
  <img id="fish_1" src="fish/fish_1.png">
  <img id="fish_2" src="fish/fish_2.png">
  <img id="fish_3" src="fish/fish_3.png">
  <img id="fish_4" src="fish/fish_4.png">
  <img id="fish_5" src="fish/fish_5.png">
  <img id="fish_6" src="fish/fish_6.png">
  <img id="fish_1_2" src="fish/fish_1.png">
  <img id="fish_4_2" src="fish/fish_4.png">
  <img id="fish_2_2" src="fish/fish_2.png">
</body>

</html>

<script>
  var resource = document.getElementById("resource");
  var word_count = document.getElementById("text");
  var y = 0;
  var itv = 5;
  var scroll_area = document.getElementById("scroll_area");
  var height = 0;
  var margin_top = 0;
  var fish_1 = document.getElementById("fish_1");
  var fish_2 = document.getElementById("fish_2");
  
  var fish_1 = gsap.timeline();
  fish_1.to("#fish_1", 1, { rotationY: 180 })
    .to("#fish_1", 2, { x: window.innerWidth - 150 })
    .to("#fish_1", 1, { rotationY: 360 })
    .to("#fish_1", 2, { x: 0 });
  fish_1.repeat(-1);

  var fish_2 = gsap.timeline();
  fish_2.to("#fish_2", 1, { rotationY: 180 })
    .to("#fish_2", 2, { x: window.innerWidth - 150 })
    .to("#fish_2", 2, { rotationY: 360 })
    .to("#fish_2", 2, { x: 0 });
  fish_2.repeat(-1);

  var fish_3 = gsap.timeline();
  fish_3.to("#fish_3", 3, { rotationY: 180 })
    .to("#fish_3", 2, { x: window.innerWidth - 150 })
    .to("#fish_3", 3, { rotationY: 360 })
    .to("#fish_3", 2, { x: 0 });
  fish_3.repeat(-1);

  var fish_4 = gsap.timeline();
  fish_4.to("#fish_4", 1, { rotationY: 180 })
    .to("#fish_4", 1, { x: window.innerWidth - 150 })
    .to("#fish_4", 1, { rotationY: 360 })
    .to("#fish_4", 1, { x: 0 });
  fish_4.repeat(-1);

  var fish_5 = gsap.timeline();
  fish_5.to("#fish_5", 1, { rotationY: 180 })
    .to("#fish_5", 5, { x: window.innerWidth - 150 })
    .to("#fish_5", 3, { rotationY: 360 })
    .to("#fish_5", 2, { x: 0 });
  fish_5.repeat(-1);

  var fish_6 = gsap.timeline();
  fish_6.to("#fish_6", 1, { rotationY: 180 })
    .to("#fish_6", 3, { x: window.innerWidth - 150 })
    .to("#fish_6", 2, { rotationY: 360 })
    .to("#fish_6", 2, { x: 0 });
  fish_6.repeat(-1);

  var fish_1_2 = gsap.timeline();
  fish_1_2.to("#fish_1_2", 1, { rotationY: 180 })
    .to("#fish_1_2", 1, { x: window.innerWidth - 150 })
    .to("#fish_1_2", 1, { rotationY: 360 })
    .to("#fish_1_2", 2, { x: 0 });
  fish_1_2.repeat(-1);

  var fish_4_2 = gsap.timeline();
  fish_4_2.to("#fish_4_2", 1, { rotationY: 180 })
    .to("#fish_4_2", 1, { x: window.innerWidth - 150 })
    .to("#fish_4_2", 1, { rotationY: 360 })
    .to("#fish_4_2", 6, { x: 0 });
  fish_4_2.repeat(-1);

  var fish_2_2 = gsap.timeline();
  fish_2_2.to("#fish_2_2", 1, { rotationY: 180 })
    .to("#fish_2_2", 3, { x: window.innerWidth - 150 })
    .to("#fish_2_2", 1, { rotationY: 360 })
    .to("#fish_2_2", 2, { x: 0 });
  fish_2_2.repeat(-1);

  function kettei() {
    document.getElementById("text").innerText = resource.value;
    $("#play").removeClass("hide");
    $("#prepare").addClass("hide");
  }

  function scrollPage() {
    clearTimeout(scrollSTOP);
    clearTimeout(Reducing);
    scroll_area.scrollTo(0, y++);
    if (y > 0) { scroll = setTimeout("scrollPage()", itv); }
  }

  function Reducing_water() {
    console.log(window.innerWidth)
    margin_top = margin_top + 1;
    height = 100 - margin_top;
    $("svg").css("margin-top", margin_top + "%");
    $("svg").css("height", height + "%");
    if (margin_top > 10) {
      fish_1.to("#fish_1", 10, { rotationX: 130 })
        .to("#fish_1", 20, { duration: 100, ease: Bounce.easeOut, y: window.innerHeight - 150, x: window.innerWidth / 2 })
    }
    Reducing = setTimeout("Reducing_water()", 1000);
  }

  function scrollSTOP() {
    clearTimeout(scroll);
    Reducing = setTimeout("Reducing_water()", 1000);
  }

  $('#wave').wavify({
    height: 0,
    bones: 80,
    amplitude: 3,
    color: '#0bd',
    speed: .25,
    phase: -90,
  });

</script>

<style>
  #fish_1 {
    position: absolute;
    top: 10%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_2 {
    position: absolute;
    top: 20%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_3 {
    position: absolute;
    top: 30%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_4 {
    position: absolute;
    top: 40%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_5 {
    position: absolute;
    top: 50%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_6 {
    position: absolute;
    top: 60%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_1_2 {
    position: absolute;
    top: 70%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_4_2 {
    position: absolute;
    top: 80%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_2_2 {
    position: absolute;
    top: 90%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }


  svg {
    position: absolute;
    margin-top: 0vh;
    bottom: 0;
    height: 100%;
    width: 100%;
    bottom: 0;
    left: - 5;
    z-index: -2;
  }

  #play {
    margin: auto;
  }

  .hide {
    visibility: hidden;
  }
</style>