<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>速読み水族館</title>
  <link href="https://fonts.googleapis.com/earlyaccess/hannari.css" rel="stylesheet">
</head>

<body>
  <div id="play" class="passive">
    <h1 class="phrase">〜早く読んで、魚を救いましょう！〜</h1>
      <h3 id="before" class="phrase active">※スクロール開始ボタンを押してください。</h3>
      <h3 id="after" class="phrase passive">※スクロール停止ボタンを押すとスクロールが停止します。しかし、水が減って魚が死にます。</h3>
    <div id="scroll_area">
      <h1 style="font-size: 80px; text-align: center; font-family: normal;" >始まり</h1>
      <p id="text" style="font-family: normal; font-size: 30px;"></p>
      <h1 style="font-size: 80px; text-align: center; font-family: normal;" >おわり</h1>
    </div>
    <div style="display: flex;">
      <input class="scroll_start" type="button" value="スクロール開始" onClick="scrollPage()">
      <input class="scroll_stop" type="button" value="スクロール停止" onClick="scrollSTOP()">
    </div>
  </div>
  <div id="prepare" class="active">
    <h1 class="phrase">〜早く読んで、魚を救いましょう！〜</h1>
    <input type="radio" name="level" value="60" checked><label for="入門" style="font-weight: bolder;">入門</label>
    <input type="radio" name="level" value="45"><label for="初段" style="font-weight: bolder;">初段</label>
    <input type="radio" name="level" value="30"><label for="二段" style="font-weight: bolder;">二段</label>
    <input type="radio" name="level" value="15"><label for="三段" style="font-weight: bolder;">三段</label>
    <input type="radio" name="level" value="5"><label for="四段" style="font-weight: bolder;">四段</label>
    <input type="radio" name="level" value="1"><label for="鬼" style="font-weight: bolder;">鬼</label>
    <h3 class="phrase">※文章を入力して決定ボタンを押してください</h3>
    <textarea name="resource" id="resource" cols="100" rows="10" style="font-size: 30px;"></textarea>
    <br>
    <input class="kettei" type="button" value="決定！" onClick="kettei()">
  </div>
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path id="wave" transform="scale(10, 10)">
  </svg>
  <img id="fish_1" src="fish/fish_1.png">
  <img id="fish_2" src="fish/fish_2.png">
  <img id="fish_3" src="fish/fish_3.png">
  <img id="fish_4" src="fish/fish_4.png">
  <img id="fish_5" src="fish/fish_5.png">
  <img id="fish_6" src="fish/fish_6.png">
  <img id="fish_1_2" src="fish/fish_1.png">
  <img id="fish_4_2" src="fish/fish_4.png">
  <img id="fish_2_2" src="fish/fish_2.png">

  </div>
  <audio id="fish_die">
    <source class="passive" src="fish_die.mp3" type="audio/mp3">
  </audio>
</body>

</html>

<style>
  #fish_1 {
    position: absolute;
    top: 10%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_2 {
    position: absolute;
    top: 20%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_3 {
    position: absolute;
    top: 30%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_4 {
    position: absolute;
    top: 40%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_5 {
    position: absolute;
    top: 50%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_6 {
    position: absolute;
    top: 60%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_1_2 {
    position: absolute;
    top: 70%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_4_2 {
    position: absolute;
    top: 80%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }

  #fish_2_2 {
    position: absolute;
    top: 90%;
    width: 150px;
    height: auto;
    transform: scale(1, 1);
    z-index: -1;
  }


  svg {
    position: absolute;
    margin-top: 0vh;
    bottom: 0;
    height: 100%;
    width: 100%;
    bottom: 0;
    left: - 5;
    z-index: -2;
  }

  #play {
    margin: auto;
  }

  .active{
    display: block;
  }

  .passive{
    display: none;
  }

  .phrase {
    color: black;
    font-family: "Hannari";
  }

  #resource {
    background-color: rgba(256, 256, 256, 0.6);
    width: 500px;
    height: 200px;
    border: 8px solid;
    resize: none;
  }

  .kettei{
    margin-left: 415px;
    width: 100px;
    height: 60px;
    color:white;
    background-color: rgba(0, 0, 0, 0.6);
    border-bottom: 5px solid black;
    outline: none;
  }

  .scroll_start{
    margin-top: 10px;
    margin-left: 285px;
    width: 110px;
    height: 60px;
    color:white;
    background-color: rgba(0, 0, 0, 0.6);
    border-bottom: 5px solid black;
    outline: none;
  }

  .scroll_stop{
    margin-top: 10px;
    margin-left: 10px;
    width: 110px;
    height: 60px;
    color:white;
    background-color: rgba(0, 0, 0, 0.6);
    border-bottom: 5px solid black;
    outline: none;
  }

  .kettei:hover {
    margin-left: 415px;
    width: 100px;
    height: 60px;
    margin-top: 3px;
    color: white;
    background: rgba(0, 0, 0, 0.6);
    border-bottom: 3px solid black;
    outline: none;
  }

  .scroll_start:hover{
    margin-top: 10px;
    margin-left: 285px;
    width: 110px;
    height: 60px;
    color:white;
    background-color: rgba(0, 0, 0, 0.6);
    border-bottom: 3px solid black;
    outline: none;
  }

  .scroll_stop:hover{
    margin-top: 10px;
    margin-left: 10px;
    width: 110px;
    height: 60px;
    color:white;
    background-color: rgba(0, 0, 0, 0.6);
    border-bottom: 3px solid black;
    outline: none;
  }

  #prepare{
    margin-top: 150px;
  }

  #play{
    margin-top: 150px;
  }

  #scroll_area{
    background-color: rgba(256, 256, 256, 0.9);
    height: 200px; 
    width: 500px; 
    border: 8px solid;
    resize: none;
    overflow:scroll; 
  }

</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.1/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/85188/jquery.wavify.js"></script>
<script>
  var resource = document.getElementById("resource");
  var y = 0;
  var level = 0;
  var scroll_area = document.getElementById("scroll_area");
  var height = 0;
  var margin_top = 0;
  var fish_1 = document.getElementById("fish_1");
  var fish_2 = document.getElementById("fish_2");
  var scroll_stop_boolean = false;
  var  fish_die = document.getElementById("fish_die"); 
  var fish_1_die = false;
  var fish_2_die = false;
  var fish_3_die = false;
  var fish_4_die = false;
  var fish_5_die = false;
  var fish_6_die = false;
  var fish_1_2_die = false;
  var fish_4_2_die = false;
  var fish_2_2_die = false;

  var fish_1 = gsap.timeline();
  fish_1.to("#fish_1", 1, { rotationY: 180 })
    .to("#fish_1", 2, { x: window.innerWidth - 150 })
    .to("#fish_1", 1, { rotationY: 360 })
    .to("#fish_1", 2, { x: 0 });
    fish_1.repeat(-1);
  var fish_2 = gsap.timeline();
  fish_2.to("#fish_2", 1, { rotationY: 180 })
    .to("#fish_2", 2, { x: window.innerWidth - 150 })
    .to("#fish_2", 2, { rotationY: 360 })
    .to("#fish_2", 2, { x: 0 });
  fish_2.repeat(-1);

  var fish_3 = gsap.timeline();
  fish_3.to("#fish_3", 3, { rotationY: 180 })
    .to("#fish_3", 2, { x: window.innerWidth - 150 })
    .to("#fish_3", 3, { rotationY: 360 })
    .to("#fish_3", 2, { x: 0 });
  fish_3.repeat(-1);

  var fish_4 = gsap.timeline();
  fish_4.to("#fish_4", 1, { rotationY: 180 })
    .to("#fish_4", 1, { x: window.innerWidth - 150 })
    .to("#fish_4", 1, { rotationY: 360 })
    .to("#fish_4", 1, { x: 0 });
  fish_4.repeat(-1);

  var fish_5 = gsap.timeline();
  fish_5.to("#fish_5", 1, { rotationY: 180 })
    .to("#fish_5", 5, { x: window.innerWidth - 150 })
    .to("#fish_5", 3, { rotationY: 360 })
    .to("#fish_5", 2, { x: 0 });
  fish_5.repeat(-1);

  var fish_6 = gsap.timeline();
  fish_6.to("#fish_6", 1, { rotationY: 180 })
    .to("#fish_6", 3, { x: window.innerWidth - 150 })
    .to("#fish_6", 2, { rotationY: 360 })
    .to("#fish_6", 2, { x: 0 });
  fish_6.repeat(-1);

  var fish_1_2 = gsap.timeline();
  fish_1_2.to("#fish_1_2", 1, { rotationY: 180 })
    .to("#fish_1_2", 1, { x: window.innerWidth - 150 })
    .to("#fish_1_2", 1, { rotationY: 360 })
    .to("#fish_1_2", 2, { x: 0 });
  fish_1_2.repeat(-1);

  var fish_4_2 = gsap.timeline();
  fish_4_2.to("#fish_4_2", 1, { rotationY: 180 })
    .to("#fish_4_2", 1, { x: window.innerWidth - 150 })
    .to("#fish_4_2", 1, { rotationY: 360 })
    .to("#fish_4_2", 6, { x: 0 });
  fish_4_2.repeat(-1);

  var fish_2_2 = gsap.timeline();
  fish_2_2.to("#fish_2_2", 1, { rotationY: 180 })
    .to("#fish_2_2", 3, { x: window.innerWidth - 150 })
    .to("#fish_2_2", 1, { rotationY: 360 })
    .to("#fish_2_2", 2, { x: 0 });
  fish_2_2.repeat(-1);

  function kettei() {
    document.getElementById("text").innerText = resource.value;
    $("#prepare").removeClass("active");
    $("#prepare").addClass("passive");
    $("#play").removeClass("passive");
    $("#play").addClass("active");
    var levels = document.getElementsByName("level");
    for(var i=0; i < 6; i++){
      if(levels[i].checked){
        level = levels[i].value;
      }
    }
  }

  function scrollPage() {
    $("#before").removeClass("active");
    $("#before").addClass("passive");
    $("#after").removeClass("passive");
    $("#after").addClass("active");
    if(scroll_stop_boolean == true){
      clearTimeout(scrollSTOP);
      clearTimeout(Reducing);
    }
    scroll_area.scrollTo(0, y++);
    if (y > 0) { scroll = setTimeout("scrollPage()", level); }
  }

  function Reducing_water() {
    console.log(window.innerWidth)
    margin_top = margin_top + 1;
    height = 100 - margin_top;
    $("svg").css("margin-top", margin_top + "%");
    $("svg").css("height", height + "%");

    if (margin_top > 90) {
      var fish_2_2 = gsap.timeline();
      fish_2_2.to("#fish_2_2",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_2_2_die == false){
            fish_die.play();
          }
          fish_2_2_die = true;
        }})
    }
    if (margin_top > 80) {
      var fish_4_2 = gsap.timeline();
      fish_4_2.to("#fish_4_2",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_4_2_die == false){
            fish_die.play();
          }
          fish_4_2_die = true;
        }})
    }
    if (margin_top > 70) {
      var fish_1_2 = gsap.timeline();
      fish_1_2.to("#fish_1_2",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_1_2_die == false){
            fish_die.play();
          }
          fish_1_2_die = true;
        }})
    }
    if (margin_top > 60) {
      var fish_6 = gsap.timeline();
      fish_6.to("#fish_6",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_6_die == false){
            fish_die.play();
          }
          fish_6_die = true;
        }})
    }
    if (margin_top > 50) {
      var fish_5 = gsap.timeline();
      fish_5.to("#fish_5",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_5_die == false){
            fish_die.play();
          }
          fish_5_die = true;
        }})
    }
    if (margin_top > 40) {
      var fish_4 = gsap.timeline();
      fish_4.to("#fish_4",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_4_die == false){
            fish_die.play();
          }
          fish_4_die = true;
        }})
    }
    if (margin_top > 30) {
      var fish_3 = gsap.timeline();
      fish_3.to("#fish_3",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_3_die == false){
            fish_die.play();
          }
          fish_3_die = true;
        }})
    }
    if (margin_top > 20) {
      var fish_2 = gsap.timeline();
      fish_2.to("#fish_2",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_2_die == false){
            fish_die.play();
          }
          fish_2_die = true;
        }})
    }
    if (margin_top > 10) {
      var fish_1 = gsap.timeline();
      fish_1.to("#fish_1",1,{autoAlpha:0,rotationX: 90,onUpdate:function(){
          if(fish_1_die == false){
            fish_die.play();
          }
          fish_1_die = true;
        }})
    }
    Reducing = setTimeout("Reducing_water()", resource.value.length);
    console.log(resource.value.length);
  }

  function scrollSTOP() {
    clearTimeout(scroll);
    scroll_stop_boolean = true;
    Reducing = setTimeout("Reducing_water()", 1000);
  }

  $('#wave').wavify({
    height: 0,
    bones: 80,
    amplitude: 3,
    color: '#0bd',
    speed: .25,
    phase: -90,
  });
</script>